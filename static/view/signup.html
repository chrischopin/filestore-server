<html>

<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>

<body>
<form>
    <div style="width:500px;margin:10px auto;text-align: center;">
        <div style="font-size:28px;font-weight:bold;margin:0px auto;">Registration</div>
        <br/>
        <table style="width:100%;text-align: left;">
            <tbody>
            <tr style="margin-bottom: 20px;">
                <td>
                    <span class="p">*</span>
                    <label for="username" class="l"> New Username:</label>
                </td>
                <td>
                    <input id="username" type="text" style="height:30px;width:250px;padding-right:50px;">
                </td>
            </tr>
            <tr>
                <td><br></td>
                <td></td>
            </tr>
            <tr style="margin-bottom: 20px;">
                <td>
                    <span class="p">*</span>
                    <label for="password" class="l"> Password:</label>
                </td>
                <td>
                    <input id="password" type="text" style="height:30px;width:250px;padding-right:50px;">
                </td>
            </tr>
            <tr>
                <td><br></td>
                <td></td>
            </tr>
            <tr style="margin-bottom: 20px;">
                <td>
                    <span class="p">*</span>
                    <label for="passwordc" class="l"> Confirm Password:</label>
                </td>
                <td>
                    <input id="passwordc" type="text" style="height:30px;width:250px;padding-right:50px;">
                </td>
            </tr>
            <tr>
                <td><br></td>
                <td></td>
            </tr>
            <tr>
                <td>
                </td>
                <td>
                    <input class="btn btn-success" type="button" style="margin:0 auto;width:250px;" value="点击注册"
                           onclick='onSignup()'/>
                    <label name='login_hint' id='login_hint' style='display:none'>注册成功，２秒后跳转到登录页面...</label>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</form>
</body>

<script lang="javascript">
    function onSignup() {
        var username = document.getElementById('username');
        var password = document.getElementById('password');
        $.ajax({
            url: "/user/signup",
            type: "POST",
            data: {
                "username": username.value,
                "password": password.value
            },
            error: function (err) {
                alert(textStatus);
            },
            success: function (data) {
                if (data == 'SUCCESS') {
                    // 成功后跳到登录页
                    document.getElementById("login_hint").style.display = "block";
                    setTimeout(() => {
                        window.location.href = '/static/view/signin.html';
                    }, 2000);

                } else {
                    alert('注册失败');
                }
            }
        });
    }
</script>
</html>
